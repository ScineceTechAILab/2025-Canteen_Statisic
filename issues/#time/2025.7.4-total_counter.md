- bug report 1: get_first_blank_row_index(work_sheet) return wrong page index 
- bug recurring:
  - debug the main_window.py and click the "store the item temporarily" and the problem will appear with the debug line jumping into "blank_row_index = get_first_blank_row_index(work_sheet)"

- fixing scheme:
- new problem:
- bug status: Not repaired

---

- bug report 2: bash report error "Error:为主表 食堂副食入库  sheet 添加合计时报错，错误信息: 'NoneType' object has no attribute 'replace'". After locating , the bug is at line "work_sheet.range((i * sheet_ratio - 1, 1)).value).replace(" ","") == "页计":"
- bug recurring:
- bug analysis:

- fixing scheme:
- new problem: `str(work_sheet.range((i * sheet_ratio - 1, 1)).value` return Null
  - bug analysis: don't take the situation that cell is null into consideration
  - fix scheme: add logic code block considering null situation 

```python
                    # 若每一页倒数第二行为空行
                    elif page_line_name == "":
                        print(f"Error: 发现 {excel_type} {work_sheet.name} 中第 {i} 页倒数第二行是空行,终止本次提交")
                        __main__.SAVE_OK_SIGNAL = False
                        raise Exception
```

- bug status: Fixed

---

- bug report 3: bash report error " self._oleobj_.Invoke(*(args + (value,) + defArgs))
  pywintypes.com_error: (-2147023174, 'The RPC server is unavailable.', None, None)"
- bug recurring:
- bug analysis:

```python
with xw.App(visible=False) as app:
    
    if  __main__.SAVE_OK_SIGNAL:

	    ...
        try:
            # 检测是否还存在未关闭的 Excel 进程，若存在则强制关闭防止因为文件被占用而无法删除
            if sys.platform == "win32":
                # Windows 系统
                subprocess.call(["taskkill", "/F", "/IM", "EXCEL.EXE"])

```

the sentence `with xw.App(visible=False) as app: ` will make the contradiction while the value of  `__main__.SAVE_OK_SIGNAL `  is true

- fixing scheme: move the try logic block outside with logic block

```python

with xw.App(visible=False) as app:

    if  __main__.SAVE_OK_SIGNAL:

        ...
try:
    # 检测是否还存在未关闭的 Excel 进程，若存在则强制关闭防止因为文件被占用而无法删除
    if sys.platform == "win32":
        # Windows 系统
        subprocess.call(["taskkill", "/F", "/IM", "EXCEL.EXE"])
```
- new problem:
- bug status: Fixed

---

- bug report 4: value  `sheet_name` store the value of  `type` .
- bug recuring:
- bug analysis: `manual_sheet.range("B2")` is wrong ，the value of type is located in colum C.

```python
    try:

        if model == "manual":

            # 打开手动模式的临时表
            manual_workbook = app.books.open(__main__.TEMP_SINGLE_STORAGE_EXCEL_PATH)
            manual_sheet = manual_workbook.sheets[0]
            
            # 检测第二行是否为空
            if manual_sheet.range("B2").value is None:
                print("Warning: 手动模式临时表的第二行为空，可能没有数据。")
                return []
            
            values = manual_sheet.range("B2:B" + str(manual_sheet.used_range.rows.count)).value
            if not isinstance(values, list):
                values = [values]
            sheets_to_add.update(filter(None, values))

        elif model == "photo":
            photo_workbook = app.books.open(__main__.PHOTO_TEMP_SINGLE_STORAGE_EXCEL_PATH)
            photo_sheet = photo_workbook.sheets[0]
            # 检测第二行是否为空
            if photo_sheet.range("B2").value is None:
                print("Warning: 图片模式临时表的第二行为空，可能没有数据。")
                return []
            values = photo_sheet.range("B2:B" + str(photo_sheet.used_range.rows.count)).value
            if not isinstance(values, list):
                values = [values]
            sheets_to_add.update(filter(None, values))

    except Exception as e:
        print(f"Error: 临时表中查找所有需要添加的sheet名失败: {e}")

    return list(sheets_to_add)
```



- fixing scheme:

```python
    try:

        if model == "manual":

            # 打开手动模式的临时表
            manual_workbook = app.books.open(__main__.TEMP_SINGLE_STORAGE_EXCEL_PATH)
            manual_sheet = manual_workbook.sheets[0]
            
            # 检测第二行是否为空
            if manual_sheet.range("C2").value is None:
                print("Warning: 手动模式临时表的第二行为空，可能没有数据。")
                return []
            
            values = manual_sheet.range("C2:C" + str(manual_sheet.used_range.rows.count)).value
            if not isinstance(values, list):
                values = [values]
            sheets_to_add.update(filter(None, values))

        elif model == "photo":
            photo_workbook = app.books.open(__main__.PHOTO_TEMP_SINGLE_STORAGE_EXCEL_PATH)
            photo_sheet = photo_workbook.sheets[0]
            # 检测第二行是否为空
            if photo_sheet.range("C2").value is None:
                print("Warning: 图片模式临时表的第二行为空，可能没有数据。")
                return []
            values = photo_sheet.range("C2:C" + str(photo_sheet.used_range.rows.count)).value
            if not isinstance(values, list):
                values = [values]
            sheets_to_add.update(filter(None, values))

    except Exception as e:
        print(f"Error: 临时表中查找所有需要添加的sheet名失败: {e}")

    return list(sheets_to_add)

```



- new problem:
- bug status: Fixed



---

- bug report 5: 

